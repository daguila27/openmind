

<ul id="container_all_products">
  <%for(var i=0; i < data.length; i++){%>
    <li style="display: flex;" class='list-group-item'>
      	
      	<div style="width: 45%"><h3><b>Nombre: </b><%=data[i].nombre%></h3></div>
      	
        <div style="width: 20%"><h4><b>Codigo: </b><%=data[i].id_producto%></h4></div>
      	<div style="width: 20%">
          <h4><b>Cantidad: </b><%=data[i].cantidadtotal%></h4>
          <h4><b>Precio: $</b><%=data[i].precioactual%></h4>
        </div>
        
      	<div style="width: 10%;" class="option">
          <form action="/product_details" method='post'>
            <input type="hidden" name="idProducto" id="idProducto<%=i%>" value="<%=data[i].id_producto%>">
            <button class='btn btn-default' type="submit">
            	<span class='glyphicon glyphicon-option-horizontal' aria-hidden='true'></span>
            </button>
          </form>
            <button class='btn btn-default editProducto' type="button" style="font-family: 'Oswald'" data-top="<%=i%>" >
              <span class='glyphicon glyphicon-pencil' aria-hidden='true'></span>
              Ajustes Stock
            </button>
        </div>
      
    </li>
  <%}%>
</ul>



<div class="container_details" style="background-color: rgb(235, 235, 235); position: absolute; right: 15%; top: -200%; transition: 1s; width: 70%; padding: 10px; box-shadow: 10px 10px 5px #888888; border: solid 1px; ">
  <h4>Editar producto: <b class="codeProducto"></b></h4>
  <div class="container" style="position: relative; width: 97%; margin-left: 3%;">
      <input type="hidden" id="codigo_producto">
      <label>Ingrese nuevo nombre:</label>
        <div class="input-group">
            <span class="input-group-addon" id="basic-addon1"></span>
            <input id="newNombre" type="text" class="form-control" placeholder="Nombre" aria-describedby="basic-addon1">
        </div>
        <label>Ingrese nuevo stock:</label>
        <div class="input-group">
            <span class="input-group-addon" id="basic-addon1"></span>
            <input id="newStock" type="text" class="form-control" placeholder="Cantidad" aria-describedby="basic-addon1">
        </div>
        <label>Ingrese nuevo precio:</label>
        <div class="input-group">
            <span class="input-group-addon" id="basic-addon1"></span>
            <input  id="newPrecio" type="text" class="form-control" placeholder="Precio" aria-describedby="basic-addon1">
        </div>
  </div>
  <div style="display: flex; margin: 10px;">
    <div class='ok' style="margin: 5px;">
      <button class='btn btn-default'><span class='glyphiconglyphicon-th-list' aria-hidden='true'></span>Editar</button>
    </div>
    <div class='cancel' style="margin: 5px;">
      <button class='btn btn-default'><span class='glyphiconglyphicon-th-list' aria-hidden='true'></span>Cancelar</button>
    </div>
  </div>
</div>
<script type="text/javascript">
      $('.editProducto').on('click', function(e){
          e.preventDefault();  
          var position = $(this).data('top');
          var top = 100 + position*90;
          $('.container_details').css('top', top+'px');
          var id = $("#idProducto"+position).val();
          $.ajax({
                type: 'GET',
                url: '/pull_data_product/'+$("#idProducto"+position).val(),
                success: function(producto){
                  console.log(producto);
                  var info = producto.split('&');
                  $("#newNombre").val(info[0]);
                  $("#newStock").val(info[1]);
                  $("#newPrecio").val(info[2]);
                  $("#codigo_producto").val(id);
                  $(".codeProducto").html(id);
                }
          });
      });
      $('.ok').on('click', function(e){
              e.preventDefault();
              $.ajax({
                type: 'POST',
                data: {
                  'codigo': $("#codigo_producto").val(),
                  'nombre': $("#newNombre").val(),
                  'stock': $("#newStock").val(),
                  'precio': $("#newPrecio").val()
                },
                url: '/editar_producto',
                success: function(data){
                      $('.container_stock').html(data);  
                      $("#codigo_producto").val('');
                      $('.container_details').css('top', '-200%');
                      alert("Producto editado correctamente");
                }
              });
      });

      $('.cancel').on('click', function(e){
              e.preventDefault();
              $('.container_details').css('top', '-200%');
                
      });

</script>
